<div class="body" >

    <div class="d-flex">

        <div class="col-lg-10 h-100 " >

            <div class="mt-1 ms-1 me-1 card shadow" style="border-radius: 5px 5px 5px 5px;min-height: 84vh;">

                <!------------------------- Search Bar Area ------------------>
                <div class="ps-2 d-flex" style="background-color: rgb(237, 233, 233);">

                    <!-------------------- Product Search Bar --------------->
                  
                   <div class="col-lg-9  d-flex flex-column ">
                       <mat-label class="text-secondary">Search Barcode / Product</mat-label> 
                      <input type="text"  #pbarcode [(ngModel)]="PBarcode"   id="searchProduct"
                      (keydown)="searchByCode($event);changeFocus($event,'.prodRow')"
                           class="p-1 ps-2 mb-2 searchProduct" placeholder="Alt + b" autofocus
                           autocomplete="off" accesskey="b">
           
                       <div class="  d-flex flex-column SearchConatiner cursorPointer"
                           *ngIf="PBarcode != '' && PBarcode != undefined">
                           <mat-card class="card " *ngFor="let item of productList| filter:PBarcode index as index"
                               (click)="holdDataFunction(item);">
                               <button style="height: 40px; background: none;border: none;text-align: left;" class="prodRow{{index}} prodBtn" (keydown)="handleProdFocus(item,$event,'.prodRow','.searchProduct',productList)">{{item.productTitle}}
                                   (<b>{{item.barcode}}</b> )</button>
                           </mat-card>
                       </div>
                   </div>
                   <div class="col-lg-3 text-start ms-1 pt-3 mt-1">
                       <button mat-raised-button class="bg-primary text-white w-50 " style="height: 40px;" (click)="ngOnInit()">Load</button>
                   </div>
       
               </div>

               <!-------------------------------Bill Products Area ------------------>

                <table class="table">
                    <thead>
                        <tr>
                            <th>S#</th>
                            <th>Title</th>
                            <th>Qty</th>
                            <th>Price</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of tableDataList index as index" (click)="showImg(item);rowFocused = index" [ngClass]="rowFocused == index ?'bg-dg':''">
                            <td>{{index +1}}</td>
                            <td>{{item.productTitle}}</td>
                            <td class=""><input type="text" [(ngModel)]="item.quantity" min="0"
                                (keydown)="this.handleNumKeys(item,$event,'.qty',index);getTotal();changeValue(item);"
                                (keyup)="changeValue(item);getTotal();showImg(item);"
                                class="qty{{index}} text-center" style="width: 80px;"></td>
                            <td>{{item.salePrice|number:'1.0-0'}}</td>
                            <td>{{item.quantity *  item.salePrice |number:'1.0-0'}}</td>
                            <td class="cursorPointer"><mat-icon (click)="delRow(item)">close</mat-icon></td>
                        </tr>
                    </tbody>
                </table>

            </div>

        </div>

        <div class="col-lg-2 h-100 card" style="position: fixed;left: 83%;">

         
            <div class="p-1 w-100" >
                <mat-card class="p-1 w-100 " style="height: 200px;width: 380px;">
                    <div class="text-center" *ngIf="tableDataList != ''" >
                        <img [src]="productImage" alt="" height="190" width="200" (click)="this.global.showProductImage(this.productImage,0)">
                    </div>
                </mat-card>
               </div>


            <div class="mt-1 ms-1 me-1 card p-2" style=" border-radius: 5px 5px 5px 5px;min-height: 55.5vh;max-height: 100%; background-color: rgb(240, 247, 245);">

                <div class="d-flex pb-2 flex-column border-bottom">
                    <div class=" pt-3   ">
                        <p style="font-size: 15px;color: rgb(0, 0, 0);">TOTAL</p>
                        <p style="font-size: 40px;color: rgb(255, 0, 0);" class="font-digit text-end">{{subTotal |number:'1.0-1'}}
                        </p>
                    </div>
                   
                    <div class="">
                        <p style="font-size: 15px;color: rgb(6, 6, 6)">DISCOUNT</p>
                        <input class="bg-transparent border-0 text-dark text-end font-digit w-100" id="disc"
                            style="font-size: 30px;" type="text" [(ngModel)]="discount" (keyup)="getTotal()"
                            (keydown)="getTotal();this.global.handleNumKeys($event);this.global.avoidMinus($event)" />
                    </div>
                    <div class="">
                        <p style="font-size: 15px;color: rgb(3, 3, 3)">NET TOTAL</p>
                        <p style="font-size: 40px;color: rgb(55, 255, 0);" class="font-digit pt-1 text-end">{{netTotal || 0
                            |number:'1.0-1'}}</p>
                    </div>
                </div>

                <div class="text-center d-flex pt-4">
                    <button class="col-lg-2 me-1" style="background-color:transparent;border-radius: 5px;" (click)="reset()"><mat-icon>delete_outline</mat-icon></button>
                    <button class="btn col-lg-10 d-flex justify-content-between btn-success me-1 pt-3" data-bs-toggle="modal" data-bs-target="#paymentMehtod">
                        <p>Save</p> <mat-icon>keyboard_arrow_right</mat-icon></button>
                    <!-- <button class="btn w-50 btn-danger">Retreive</button> -->
                </div>

            </div>


        </div>
        
    </div>

</div>





  <!----------------Modal Window for Payment Mehtod ---------->



  <div class="modal fade" id="paymentMehtod" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false"
  aria-labelledby="paymentMehtodLabel">
  <div class="modal-dialog modal-dialog-centered ">
      <div class="modal-content " style="background-color: rgb(248, 247, 247);">
          <div class="modal-header">
              <h2 class="modal-title" id="paymentMehtodLabel">Payment Method</h2>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">


              <div class="d-flex justify-content-between">
                  <h2 class="text-center text-success">Bill Total: {{netTotal | number:'1.0-1'}}</h2>
                  <h2 class="text-center text-danger">Change: {{ change | number:'1.0-1'}}</h2>
              </div>

              <mat-form-field appearance="outline" class="w-100">
                  <mat-label>Payment Type</mat-label>
                  <mat-select [(ngModel)]="paymentType" (selectionChange)="cash = 0; bankCash = 0;getTotal()">
                      <mat-option value="Cash">Cash</mat-option>
                      <mat-option value="Bank">Bank</mat-option>
                      <mat-option value="Split">Split</mat-option>
                  </mat-select>
              </mat-form-field>

              <mat-card class=" p-2 bg-warning" *ngIf="paymentType !== ''">

                  <div class="d-flex justify-content-between text-center mb-2"
                      *ngIf="paymentType == 'Cash' || paymentType == 'Split'">
                      <mat-label style="font-size: 25px;">Cash:</mat-label>
                      <input type="number" style="font-size: 25px;width: 120px;" (keydown)="this.global.handleNumKeys($event);getTotal()"
                          (keyup)="getTotal()" [(ngModel)]="cash" />
                  </div>

                  <div class="d-flex justify-content-between  "
                      *ngIf="paymentType == 'Bank' || paymentType == 'Split'">
                      <mat-label style="font-size: 25px;">Bank:</mat-label>
                      <select [(ngModel)]="bankCoaID " style="width: 150px;">
                          <option *ngFor="let item of bankCoaList" [value]="item.coaID">{{item.coaTitle}}</option>
                      </select>
                      <input type="number" style="font-size: 25px;width: 120px;" (keydown)="this.global.handleNumKeys($event);getTotal()"
                          (keyup)="getTotal()" [(ngModel)]="bankCash" />
                  </div>

              </mat-card>


          </div>

          <div class="modal-footer bg-mf-blue">
              <button class="btn btn-success" (click)="save('sale')">Save</button>
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>


      </div>
  </div>
</div>

<!---------------------------------------------------------->

