<div class="body bg-gray">
    <div class="col-lg-3 bg-white  p-3 row d-none" style="height: 85vh;overflow-y: auto;">

        <h1>User Credentials</h1>


        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>User Name</mat-label>
            <input matInput type="text" [(ngModel)]="UserName">
        </mat-form-field>

        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>Login Name</mat-label>
            <input matInput type="text" [(ngModel)]="loginName">
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>User Email</mat-label>
            <input matInput type="email" [(ngModel)]="userEmail">
        </mat-form-field>


        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>Mobile No</mat-label>
            <input matInput type="text" maxlength="12" [textMask]="{mask: mobileMask}" [(ngModel)]="mobileNo">
            <mat-hint>{{mobileNo.length}}/12</mat-hint>
        </mat-form-field>

        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>User Role</mat-label>
            <mat-select type="text" [(ngModel)]="RoleID">
                <mat-option *ngFor="let item of rolesList" [value]="item.roleID">{{item.roleTitle}}</mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>Role Type</mat-label>
            <mat-select type="text" [(ngModel)]="roleTypeID">
                <mat-option *ngFor="let item of roleTypeList"
                    [value]="item.roleTypeID">{{item.roleTypeTitle}}</mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>Project</mat-label>
            <mat-select type="text" [(ngModel)]="projectID">
                <mat-option *ngFor="let item of projectList" [value]="item.projectID">{{item.projectTitle}}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>Password</mat-label>
            <input [disabled]="btnType == 'Update'" matInput type="password" [(ngModel)]="password">
        </mat-form-field>
        <mat-form-field appearance="outline" class="w-100 matSmall">
            <mat-label>Confirm Password</mat-label>
            <input [disabled]="btnType == 'Update'" matInput type="password" [(ngModel)]="confirmPassword">
        </mat-form-field>


        <div class="text-center">
            <button mat-raised-button class="bg-success text-white me-2 "(click)="save()">{{btnType}}</button>
      
            <button mat-raised-button color="warn" (click)="reset()">Reset</button>
        </div>






    </div>
    <div class="col-lg-12 container">
        <!-- <h1>Saved Record</h1> -->

      <div class="row">
          <button  mat-raised-button  (click)="addNewUser()" style="height: 42px;"  class="bg-success text-white col-md-2">Add User</button>
          <mat-form-field class="col-md-10 matSmall" appearance="outline">
            <mat-label>Search.....</mat-label>
            <input [(ngModel)]="txtSearch" matInput type="text" #input>
        </mat-form-field>
      
      </div>


        <table class="table-logix2 cursorPointer" style="overflow: scroll;" *ngIf="crudList.r">
            <thead>
                <tr>
                    <th>User Name</th>
                    <th>Login Name</th>
                    <th>Project</th>
                    <th>Role</th>
                    <th>Mobile</th>
                    <th *ngIf="crudList.u">Edit</th>
                    <th *ngIf="crudList.u">Reset PIN</th>
                    <th *ngIf="crudList.u">Password</th>
                    <th *ngIf="crudList.u">Block</th>
                    <th *ngIf="crudList.d">Delete</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of userList | filter:txtSearch">
                    <td>{{item.userName}}</td>
                    <td>{{item.loginName}}</td>
                    <td>{{item.projectTitle}}</td>
                    <td>{{item.roleTitle}}</td>
                    <td>{{item.mobileNo}}</td>
                    <td *ngIf="crudList.u"><button mat-mini-fab class="bg-success h30px w30px"
                            (click)="editUser(item)"><mat-icon>edit</mat-icon></button></td>
                    <td *ngIf="crudList.u"><button mat-mini-fab class="bg-primary h30px w30px "
                            (click)="resetPin(item)"><mat-icon>vpn_key</mat-icon></button></td>
                    <td *ngIf="crudList.u"><button mat-mini-fab class="h30px w30px "
                            style="background-color: rgb(57, 154, 183);"
                            (click)="ChangePassword(item.userID)"><mat-icon>lock</mat-icon></button></td>
                    <td *ngIf="crudList.u"><button mat-mini-fab class="bg-warning h30px w30px"
                            *ngIf="item.tempBlock == false "
                            (click)="blockUser(item,true)"><mat-icon>block</mat-icon></button>
                        <button mat-mini-fab *ngIf="item.tempBlock == true " (click)="blockUser(item,false)"
                            class="bg-white text-dark h30px w30px"> <mat-icon>block</mat-icon></button>
                    </td>
                    <td *ngIf="crudList.d"><button mat-mini-fab class="bg-danger h30px w30px"
                            (click)="deleteUser(item)"><mat-icon>delete</mat-icon></button></td>
                </tr>
            </tbody>
        </table>


    </div>
</div>


<div class="modal fade" id="addUser" data-bs-focus="false" tabindex="-1" aria-labelledby="addUserLabel" aria-hidden="true"
    data-bs-backdrop="false">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title" id="addUserLabel">User Details</span>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <app-user-form [rolesList]="rolesList" [projectList]="projectList"></app-user-form>
            </div>
            <div class="modal-footer bg-mf">
                <button type="button" class="btnsave" (click)="save()">{{btnType}}</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>

            </div>
        </div>
    </div>
</div>